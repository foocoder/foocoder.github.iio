<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>

一道简单的题目引发的思考 | Meta Coder

</title>
<meta name="description" content=" Reading, Thinking, Coding">
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/feed.xml">
<!-- include Font Awesome -->
<link rel="stylesheet" href="/font_awesome/css/font-awesome.min.css" >
<!-- include Font Awesome -->
<!-- icons -->
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<!--<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">-->
<meta name="theme-color" content="#00f0ff">
<meta name="msapplication-TileColor" content="#00f0ff">
<meta name="msapplication-TileImage" content="/mstile-310x310.png">
<!-- /icons -->
<!-- og tags -->
<meta property="og:site_name" content="Meta Coder">
<meta property="og:title" content="一道简单的题目引发的思考 • Meta Coder">
<meta property="og:locale" content="en">

  
    <meta property="og:image" content="http://foocoder.github.io/img/9.jpg">
  

<meta property="og:type" content="website">
<meta property="og:url" content="http://foocoder.github.io/c/c++/2016/03/09/%E4%B8%80%E9%81%93%E7%AE%80%E5%8D%95%E7%9A%84%E9%A2%98%E7%9B%AE%E5%BC%95%E5%8F%91%E7%9A%84%E6%80%9D%E8%80%83/">
<meta property="og:description" content="

Reading, Thinking, Coding
">
<!-- /og tags -->
<script src="/js/jquery-2.1.4.min.js"></script>
<script src="/js/modernizr.js"></script>
<script src="/js/fitvids.js"></script>
<script>
$("#back-top").hide();
$(document).ready(function () {
  $(window).scroll(function () {
    if ($(this).scrollTop() > 100) {
      $('#back-top').fadeIn();
    } else {
      $('#back-top').fadeOut();
    }
  });
  $('#back-top a').click(function () {
    $('body,html').animate({
      scrollTop: 0
    }, 800);
    return false;
  });
});
</script>
<link href='//fonts.useso.com/css?family=Source+Code+Pro:400,700|Source+Sans+Pro:600,900|Open+Sans:400,600' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/css/reset.css">
<link rel="stylesheet" href="/css/pygments.css">

    <link rel="stylesheet" href="/font_awesome/css/font-awesome.min.css">

<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="/css/style.css">
<!--[if gte IE 9]>
  <style type="text/css">
    .gradient {
       filter: none;
    }
  </style>
<![endif]-->

<style>
header {
  margin-bottom: 40px;
}
@media all and (min-width: 500px) {
  header {
    margin-bottom: 100px;
  }
}
header::after {
  display: none;
}
</style>


    </head>
    <body>
        
        <div class="cover-image-container">
            <img alt="Cover image" src="/img/covers/9.jpg" style="width:100%">
        </div>
        
        
        <div id="back-top" style="display:none">
          <a href="#top" title="回到顶部">
              <span class="fa fa-stack fa-lg">
                  <i class="fa fa-square fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-arrow-up fa-inverse"></i>
              </span>
          </a>
        </div>
        
        <header class="intro-header-container" style="background-image: url('/img/covers/9.jpg'); background-size:cover">
  <div class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 ">
                <div class="site-heading">
                    
                </div>
            </div>
        </div>
    </div>
  </div>
</header>
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Meta Code</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar" class=" ">
            <div class="navbar-collapse" style="height: 0px;">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/about/">ABOUT</a>
                    </li>
                    <li>
                        <a href="/archive/">ARCHIVE</a>
                    </li>
                    <li>
                        <a href="/category/">CATEGORY</a>
                    </li>
                    <li>
                        <a href="/tags/">TAGS</a>
                    </li>
                    <li>
                        <a href="/reading/">BOOK</a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


        <div class="wrap">
            <article>
        <h1>一道简单的题目引发的思考</h1>
        <div class="category">
            
                <a class="fa fa-coffee" style="font-size:large" href="/category/#C/C++" title="C/C++"> C/C++</a>
            
        </div>
        <div class="tags">
            
            <a class="fa fa-thumb-tack" style="font-size:large" href="/tags/#转载" title="转载">  转载</a>
            
            <a class="fa fa-thumb-tack" style="font-size:large" href="/tags/#C/C++" title="C/C++">  C/C++</a>
            
            <a class="fa fa-thumb-tack" style="font-size:large" href="/tags/#汇编" title="汇编">  汇编</a>
            
        </div>
        <div class="times">
            <span class="fa fa-calendar"style="font-size:large" > Mar 9, 2016</span>
        </div>

        <hr>
        <p>本文来自于@吴秦(Tyler)的个人博客，详细的记录了博主一次发现问题，解决问题，发散问题的过程。本人很佩服博主的这种求本溯源的精神。转载过来留个念。</p>

<blockquote>
  <p>原文地址：<a href="http://www.cnblogs.com/skynet/archive/2010/07/11/1775084.html">一道简单的题目引发的思考</a></p>
</blockquote>

<h2 id="section">引言</h2>

<p>昨晚一时兴起，我脑子就问自己下面的代码会输出什么，也不知道我脑子为什么有这个代码模型，只是模糊的有些印象：</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="n">j</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">++</span><span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"i = %d, j = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>您会怎样考虑这个问题呢？您不运行这个程序能准确地说出答案吗？我猜想肯定有大部分人不能肯定且准确地说出答案！如果您不能，这篇文章就是为你准备的，保证您看完之后豁然开朗！请细看下文，outline如下：</p>

<ul>
  <li>1.诸君的回答
    <ul>
      <li>1.1 A君的回答</li>
      <li>1.2 B君的回答</li>
      <li>1.3 C君的回答</li>
      <li>1.4 D君的回答</li>
    </ul>
  </li>
  <li>2.编译器的输出
    <ul>
      <li>2.1 Visual Studio的输出</li>
      <li>2.2 GCC的输出</li>
      <li>2.3 Visual C++ 2010的输出</li>
    </ul>
  </li>
  <li>3.分析
    <ul>
      <li>3.1 gcc编译器上的分析</li>
      <li>3.2 分析gcc编译之后的汇编代码</li>
      <li>3.3 vs编译器上的分析</li>
      <li>3.4 分析VS编译之后的汇编代码</li>
    </ul>
  </li>
  <li>4.扩散思维
    <ul>
      <li>4.1 思维放射</li>
      <li>4.2 VS的输出</li>
      <li>4.3 GCC的输出</li>
    </ul>
  </li>
  <li>5.感慨</li>
</ul>

<h2 id="section-1">1.诸君的回答</h2>

<p>我那这道题目问了几个人，他们的答案不尽相同。</p>

<h3 id="a">1.1 A君的回答</h3>

<p>因为i = 3，故依次i++=4，i++=5，++i=6，i最后输出为i = 6；但是由于前面两个++是后置++，最后一个++是前置++，故j = 3+4+6 = 13。</p>

<h3 id="b">1.2 B君的回答</h3>

<p>因为i = 3，故第一个i++后为4，第二个i++后为5，接着做i+i操作 = 5+5=10，最后与(++i)相加 = 10+6=16。</p>

<h3 id="c">1.3 C君的回答</h3>

<p>因为i = 3，故依次i++=4，i++=5，++i=6，i最后输出为i = 6；但是第一i、第二个i的++是后置++，先进行i+i操作，然后进行两次i++后置操作，故等价于(i)+(i) = 3+3=6，i++，i++，最后与++i=6相加等于12。</p>

<h3 id="d">1.4 D君的回答</h3>

<p>因为i = 3，故依次i++=4，i++=5，++i=6，i最后输出为i = 6；但是前面两个++都是后置++，故先做i+i+(++i)操作，然后才在i++,i++操作，第三个++是前置++，故等价于 i+i+(++i)=3+3+4=10，i++，i++。</p>

<p>到底哪个人说得对呢？</p>

<h2 id="section-2">2.编译器的输出</h2>

<p>首先让我们先来看看编译器会输出什么?</p>

<h3 id="visual-studio">2.1 Visual Studio的输出</h3>

<p>运行环境：Win7+VS2005 or VS2010，输出如下图所示：</p>

<p><img src="/img/160309_0.png" alt="" /></p>

<h3 id="gcc">2.2 GCC的输出</h3>

<p>运行环境：Ubuntu 10.04+gcc (Ubuntu 4.4.3-4ubuntu5) 4.4.3，运行结果如下：</p>

<p><img src="/img/160309_1.png" alt="" /></p>

<h3 id="visual-c">2.3 Visual C++的输出</h3>

<p>运行环境：Win7+VC2010，输出和VS一样，及i = 6 &amp; j = 12</p>

<p>看到这里你肯定想问why? why?? why???</p>

<h2 id="section-3">3.分析</h2>

<p>重编译器的输出结果来看貌似C君、D君的分析都是对的，这种差异跟编译器有直接的关系，因为对于这个表达式怎么编译还没有形成标准，编译器的结合方向不同，答案因此会有所不同。而且当然还包括运算符的优先级等。其实顶多算C君答对了一部分，其他几个人的回答都是错的，详情见下面的分析。</p>

<h3 id="gcc-1">3.1 gcc编译器上的分析</h3>

<p>(i++)+(i++)+(++i) &lt;=&gt; i+i+(++i); i++; i++;即如果表达式中含有i++，一律替换成i，然后在表达式之后进行i++操作。</p>

<p>这样的话上面的代码就可以很好的理解了，即3+3+4=10。</p>

<h3 id="gcc-2">3.2 分析gcc编译之后的汇编代码</h3>

<p>可以对gcc编译之后的执行文件进行反编译分析验证正确性。在Linux下面可以用objdump –d xxx(执行文件)命令反汇编执行文件。反编译之后可以看到如下图所示的代码：</p>

<p><img src="/img/160309_2.png" alt="" /></p>

<blockquote>
  <p>说明：Linux下采用的是AT＆T的汇编语法格式，Windows下面采用的是Intel汇编语法格式。二者的主要区别在于：</p>

  <p>指令操作数的赋值方向是不同的<br />
  Intel：第一个是目的操作数，第二个是源操作数 <br />
  AT＆T：第一个是源操作数，第二个是目的操作数</p>

  <p>指令前缀 <br />
  AT＆T：寄存器前边要加上％，立即数前要加上$ <br />
  Intel：没有这方面的要求<br /></p>

  <p>内存单元操作数 <br />
  Intel：基地址使用［］ <br />
  AT&amp;T：  基地址使用（） <br />
 比如：<br />
       intel中  mov  ax,[bx] <br />
       AT&amp;T中 movl (%eax),%ebx</p>

  <p>操作码的后缀 <br />
    AT&amp;T中操作码后面有一个后缀字母:“l” 32位,“w” 16位,“b” 8位 <br />
    Intel却使用了在操作数前面加dword ptr, word ptr, byte ptr的格式<br /> 
  例如:<br />
mov al,bl (Intel) <br />
movb %bl %al (AT&amp;T) <br /></p>

  <p>AT＆T中跳转指令标号后的后缀 表示跳转方向，“f”表示向前，“b”表示向后</p>
</blockquote>

<p>下面我们重点分析红框中的代码：</p>

<figure class="highlight"><pre><code class="language-asm" data-lang="asm">movl  $0x3 ,0x1c(%esp) ;将3赋给i，即i=3 
mov   0x1c(%esp) ,%eax ;将esp中的i放到eax中 
add   %eax ,%eax       ;进行i+i操作，即3+3 
addl  $0x1 ,0x1c(%esp) ;对i进行加1操作，即表达式中的(++i) 
add   0x1c(%esp),%eax  ;将eax中i+i的结果6，加上++i之后的i，即6+4=10 
addl  $0x1 ,0x1c(%esp) ;对i进行加1操作，即表达式中的(i++) 
addl  $0x1 ,0x1c(%esp) ;对i进行加1操作，即表达式中的(i++)</code></pre></figure>

<p>至此关键代码已经分析完成，由此可见我们之前对gcc编译器上的分析是正确的。</p>

<h3 id="vs">3.3 vs编译器上的分析</h3>

<p>(i++)+(i++)+(++i) &lt;=&gt;(++i)+i+i; i++; i++;即如果表达式中含有前置++i，首先执行++i操作；表达式中的i++，一律换成i，然后执行加法操作；最后在进行i++操作。</p>

<p>这样的话上面的代码就可以很好的理解而来，即首先执行++i，i变为4了；然后进行i+i+i=4+4+4；i++，i++。</p>

<p>其实对于VS/VC2010编译器中的可以总结为：当用于四则运算时，前置++/–的运算优先级最高，后置++/–的运算优先级最小，其它的居中。（跟你书上看到是不是不同！）</p>

<h3 id="vs-1">3.4 分析VS编译之后的汇编代码</h3>

<p>用W32Dasm反汇编vs编译生成的exe文件，追踪代码。我们可以看到如下图所示的代码：</p>

<p><img src="/img/160309_3.png" alt="" /></p>

<p>下面重点分析一下框中代码：</p>

<figure class="highlight"><pre><code class="language-asm" data-lang="asm">mov [ebp-08],3             ;将3赋给i，即i=3 
mov eax,dword ptr [ebp-08] ;将ebp中的i的值放到eax中，是"累加器"(accumulator), 它是很多加法乘法指令的缺省寄存器。dword ptr表示这是一个双字指针，即所要寻址的数据是一个双字（4字节） 
add eax,1                  ;对eax中的i进行加1操作 
mov dword ptr [ebp-08] ,eax;将eax中的i赋给ebp中i，即将i加1之后的值赋给i，也即达到i=i+1的效果 
mov ecx,dword ptr [ebp-08] ;将ebp中的i放到ecx中 
add ecx,dword ptr [ebp-08] ;将ebp中的值加上i，即4+4 
add ecx,dword ptr [ebp-08] ;将ebp中的值加上i，即4+4+4 
mov dword ptr [ebp-14],ecx ;将ecx中的值赋给j 
mov edx,dword ptr [ebp-08] ;将i放到edx中 
add edx,1                  ;对edx中的i进行加1操作 
mov dword ptr [ebp-08] ,edx;将edx中的i赋给ebp中i，即将i加1之后的值赋给i，也即达到i=i+1的效果 
mov eax,dword ptr [ebp-08] ;将i放到eax中 
add eax,1                  ;对eax中的i进行加1操作 
mov dword ptr [ebp-08] ,eax;将eax中的i赋给ebp中i，即将i加1之后的值赋给i，也即达到i=i+1的效果</code></pre></figure>

<p>至此，上面表达式的关键运算部分已经分析完成。从这里可以知道，上面我们地VS编译器的分析是正确的。</p>

<h2 id="section-4">4.发散思维</h2>

<p>可以说通过上面那么篇幅的介绍，我们对涉及前置++和后置++的加法运算表达式的计算过程有了一个清楚的认识，下面就我们发散一下我们的思维，释放我们的能量。</p>

<h3 id="section-5">4.1 思维放射</h3>

<p>您看下面的代码会输出什么，现在知道了吧！</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
</span> 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">result1</span><span class="p">,</span><span class="n">result2</span><span class="p">,</span><span class="n">result3</span><span class="p">,</span><span class="n">result4</span><span class="p">,</span><span class="n">result5</span><span class="p">,</span><span class="n">result6</span><span class="p">;</span>
    <span class="n">result1</span><span class="o">=</span><span class="p">(</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">++</span><span class="n">i</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"i = 3</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"result1= (++i)+(++i) = %d</span><span class="se">\n\n</span><span class="s">"</span><span class="p">,</span><span class="n">result1</span><span class="p">);</span>
 
    <span class="n">result2</span><span class="o">=</span><span class="p">(</span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">++</span><span class="p">);</span>    
    <span class="n">printf</span><span class="p">(</span><span class="s">"j = 3</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"result2= (j++)+(j++) = %d</span><span class="se">\n\n</span><span class="s">"</span><span class="p">,</span><span class="n">result2</span><span class="p">);</span>
 
    <span class="n">result3</span><span class="o">=</span><span class="p">(</span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">++</span><span class="n">k</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"k = 3</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"result3= (++k)+(++k)+(++k) = %d</span><span class="se">\n\n</span><span class="s">"</span><span class="p">,</span><span class="n">result3</span><span class="p">);</span>
 
    <span class="n">result4</span><span class="o">=</span><span class="p">(</span><span class="o">++</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">++</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">l</span><span class="o">++</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"l = 3</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"result4= (++l)+(++l)+(l++) = %d</span><span class="se">\n\n</span><span class="s">"</span><span class="p">,</span><span class="n">result4</span><span class="p">);</span>
 
    <span class="n">result5</span><span class="o">=</span><span class="p">(</span><span class="n">m</span><span class="o">++</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">m</span><span class="o">++</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">m</span><span class="o">++</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"m = 3</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"result5=(m++)+(m++)+(m++) = %d</span><span class="se">\n\n</span><span class="s">"</span><span class="p">,</span><span class="n">result5</span><span class="p">);</span>
 
    <span class="n">result6</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="o">++</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">++</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">n</span><span class="o">++</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"n = 3</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"result6=(n++)+(++n)+(n++) = %d</span><span class="se">\n\n</span><span class="s">"</span><span class="p">,</span><span class="n">result6</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>请不看结果先自己分析一下，然后和结果对比！</p>

<h3 id="vs-2">4.2 VS的输出</h3>

<p>运行环境：Win7+VS2005 or VS2010，输出如下图所示：</p>

<p><img src="/img/160309_4.png" alt="" /></p>

<h3 id="gcc-3">4.3 GCC的输出</h3>

<p>运行环境：Ubuntu 10.04+gcc (Ubuntu 4.4.3-4ubuntu5) 4.4.3，运行结果如下：</p>

<p><img src="/img/160309_5.png" alt="" /></p>

<p>根据前面我们挖掘到的规则，我们可以得到result3之外所有其它答案。最后，还有一点要说明的是：<strong>gcc中的加法运算表达死中，是按照从左到右按顺序，如果运算符两边有++i操作数，就先进行++i操作，然后进行加法运算；vs中的加法运算表达式中，则不一样，只要表达式中有++i操作数，就要先计算，最后才是进行加法运算。</strong>这也是为什么result3不同的原因！加法运算可以扩展到减法、乘法、除法运算和前置–、后置–。但是如果是四则混合运算还要考虑加、减、乘、除的优先级问题。</p>

<h2 id="section-6">5.感慨</h2>

<p>通过这么多分析，我们可以算得上是对涉及++、–的运算表达式计算过程有了透彻理解！
我在挖掘这个计算过程的路上，可是化了不少功夫也在刚开始分析汇编代码时遇到了一些困难，但这颗求知的心，推动着我坚持要去弄清楚它！
<strong>最后我想说：请不要写这种语句！理由很简单，它既不好理解又不好维护，最重要的是它的结果会因编译器的不同而不同。</strong></p>


        <hr>
        <p>09 Mar 2016</p>
        
            
                
                    <small><em>Post by: MetaCoder </em></small>
                
            
        
</article>


<div class="pagination clearfix">
    <div class="left">
        
        <a href="/c/c++/2016/04/03/Const%E9%99%90%E5%AE%9A%E7%AC%A6/">‹ Next post</a>
        
    </div>
    <div class="right">
        
        <a href="/c/c++/2016/03/06/details-about-sizeof/">Previous post ›</a>
        
    </div>
</div>



<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'foocoder'; // Required - Replace '<example>' with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


            <script>
                $("article").fitVids();
                $('article p').each(function(i){
                    if (($(this).find('img').length) && (!$.trim($(this).text()).length))  {
                        $(this).addClass('img-only');
                    }
                    if ($.trim($(this).text()).length - $.trim($(this).find('small').text()).length == 0 && ($(this).find('img').length)){
                        $(this).removeClass('img-only');
                        $(this).addClass('img-with-source');
                    }
                });
            </script>
            <!-- FancyBox -->
            <link rel="stylesheet" href="/fancybox/source/jquery.fancybox.css?v=2.1.5" type="text/css" media="all" />
            <script type="text/javascript" src="/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
            <script type="text/javascript" src="/fancybox/lib/jquery.mousewheel-3.0.6.pack.js"></script>
            <script>
            // 给图片添加链接
            $(document).ready(function() {
              $('.img-with-source img,.img-only img').each(function () {
                var $image = $(this);
                var $imageWrapLink = $image.parent('a');

                if ($imageWrapLink.size() < 1) {
                  $imageWrapLink = $image.wrap('<a href="' + this.getAttribute('src') + '"></a>').parent('a');
                }
                $imageWrapLink.addClass('fancybox');
                if ($image.attr("alt")) {
                  $imageWrapLink.append('<div class="pic-title"><span>' + $image.attr("alt") + '</span></div>');
                  $imageWrapLink.attr("title",$image.attr("alt")); 
                };
              });
            });
            // fancybox
            $(".fancybox").fancybox({
              openEffect    : 'fade',
              closeEffect   : 'fade',
              helpers: {
                overlay: {
                  locked: false
                }
              }
            });
            </script>
        </div>
        <footer>
  <div class="inner">
    <p>Copyright © MetaCoder 2014~2016 </br> Powered by Jekyll</p>
  </div>
</footer>

        
        
            <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "//hm.baidu.com/hm.js?93c048bb9273a232e5e814272f1409b7";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
            </script>
        
    </body>
</html>

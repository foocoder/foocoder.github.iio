<!DOCTYPE html>
<html lang="{{ site.lang }}" prefix="og: http://ogp.me/ns#">
    <head>
        {% include head.html %}
    </head>
    <body>
        {% if page.cover-image %}
        <div class="cover-image-container">
            <img alt="Cover image" src="{{ site.baseurl }}/img/covers/{{ page.cover-image }}" style="width:100%">
        </div>
        {% endif %}
        {% if site.enabletoTop %}
        <div id="back-top" style="display:none">
          <a href="#top" title="回到顶部">
              <span class="fa fa-stack fa-lg">
                  <i class="fa fa-square fa-stack-2x"></i>
                  <i class="fa fa-stack-1x fa-arrow-up fa-inverse"></i>
              </span>
          </a>
        </div>
        {% endif %}
        {% include header.html %}
        <div class="wrap">
            {{ content }}
            <script>
                $("article").fitVids();
                $('article p').each(function(i){
                    if (($(this).find('img').length) && (!$.trim($(this).text()).length))  {
                        $(this).addClass('img-only');
                    }
                    if ($.trim($(this).text()).length - $.trim($(this).find('small').text()).length == 0 && ($(this).find('img').length)){
                        $(this).removeClass('img-only');
                        $(this).addClass('img-with-source');
                    }
                });
            </script>
            <!-- FancyBox -->
            <link rel="stylesheet" href="/fancybox/source/jquery.fancybox.css?v=2.1.5" type="text/css" media="all" />
            <script type="text/javascript" src="/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
            <script type="text/javascript" src="/fancybox/lib/jquery.mousewheel-3.0.6.pack.js"></script>
            <script>
            // 给图片添加链接
            $(document).ready(function() {
              $('.img-with-source img,.img-only img').each(function () {
                var $image = $(this);
                var $imageWrapLink = $image.parent('a');

                if ($imageWrapLink.size() < 1) {
                  $imageWrapLink = $image.wrap('<a href="' + this.getAttribute('src') + '"></a>').parent('a');
                }
                $imageWrapLink.addClass('fancybox');
                if ($image.attr("alt")) {
                  $imageWrapLink.append('<div class="pic-title"><span>' + $image.attr("alt") + '</span></div>');
                  $imageWrapLink.attr("title",$image.attr("alt")); 
                };
              });
            });
            // fancybox
            $(".fancybox").fancybox({
              openEffect    : 'fade',
              closeEffect   : 'fade',
              helpers: {
                overlay: {
                  locked: false
                }
              }
            });
            </script>
        </div>
        {% include footer.html %}
        {% if site.googleAnaly.config %}
            <script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

              ga('create', '{{ site.googleAnaly.id }}', 'auto');
              ga('send', 'pageview');

            </script>
        {% endif %}
        {% if site.baiduAnaly.config %}
            <script>
            var _hmt = _hmt || [];
            (function() {
              var hm = document.createElement("script");
              hm.src = "//hm.baidu.com/hm.js?93c048bb9273a232e5e814272f1409b7";
              var s = document.getElementsByTagName("script")[0]; 
              s.parentNode.insertBefore(hm, s);
            })();
            </script>
        {% endif %}
    </body>
</html>
